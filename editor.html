<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>웹사이트 에디터</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js">
function savePage() {
  const title = document.getElementById('title').value;
  const slug = document.getElementById('slug').value.trim() || 'untitled';
  const description = document.getElementById('description').value;

  const content = Array.from(editorArea.children).map(el => {
    const clone = el.cloneNode(true);
    clone.querySelectorAll('.delete-btn, input, select').forEach(e => e.remove());
    clone.querySelectorAll('[contenteditable]').forEach(e => {
      const p = document.createElement('p');
      p.innerHTML = e.innerHTML;
      e.replaceWith(p);
    });
    return clone.outerHTML;
  }).join('\n');

  const finalHTML = `<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>${title}</title>
  <style>
    h1 { text-align: center; }
    body { text-align: center; }
    img { max-width: 100%; }
    .button {
      display: inline-block;
      padding: 8px 16px;
      background-color: #000;
      color: #fff;
      text-decoration: none;
      margin-top: 6px;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <h1>${title}</h1>
  <p>${description}</p>
  ${content}
</body>
</html>`;

  const blob = new Blob([finalHTML], { type: 'text/html' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = slug.endsWith('.html') ? slug : slug + '.html';
  a.click();
}
    </script>
    <style>
          body {
                font-family: Pretendard, sans-serif;
                max-width: 1080px;
                margin: 3rem auto;
                padding: 0 1.5rem;
                background-color: #f5f7fa;
                color: #333;

        }

          input, textarea {
                width: 100%;
                padding: 0.8rem;
                margin-bottom: 1rem;
                font-size: 1.05rem;
                border: 1px solid #ccc;
                border-radius: 6px;
                background: white;

        }

          button {
                padding: 0.5rem 1.0rem;
                font-size: 1.05rem;
                cursor: pointer;
                margin-right: 0.5rem;
                border: none;
                border-radius: 6px;
                background-color: #89b4e2;
                color: white;
                transition: background 0.3s;

        }

              button:hover {
                    background-color: #629edf;

            }

          label {
                font-weight: bold;
                display: block;
                margin-bottom: 0.5rem;

        }

          h1 {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            color: #222;
        }

          #editor-area {
                min-height: 200px;
                border: 2px dashed #ccc;
                padding: 1rem;
                margin-bottom: 1.5rem;
                background-color: #ffffff;
                border-radius: 8px;

        }

          .editor-block {
                text-align: center;
                border: 1px solid #bbb;
                padding: 12px;
                margin: 8px 0;
                background: #ffffff;
                border-radius: 6px;
                position: relative;
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);

        }

              .editor-block img {
                    max-width: 100%;
                    height: auto;
                    border-radius: 4px;
                    resize: both;
                    overflow: auto;
                    width: 50%;
                    min-width: 50px;

            }

              .editor-block .button {
                    display: inline-block;
                    padding: 8px 16px;
                    background-color: #000;
                    color: #fff;
                    text-decoration: none;
                    margin-top: 6px;
                    border-radius: 6px;

            }

        .button-group {
              display: flex;
              flex-wrap: wrap; /* 줄바꿈 허용 */
              gap: 0.5rem;
              margin-bottom: 1rem;
        }

        form {
              max-width: 100%;
              width: 100%;
              box-sizing: border-box;
        }

        /* 모든 입력 요소가 반응형으로 */
        input,
        textarea {
              width: 100%;
              max-width: 100%;
              box-sizing: border-box;
        }

        /* JSON 불러오기 섹션 정리 */
        form label[style*="inline-block"] {
              display: block;
              width: 100%;
        }


        @media (max-width: 768px) {
              body {
                    padding: 1rem;

            }

              h1 {
                    font-size: 1.5rem;

            }

              input,
              textarea {
                    font-size: 1rem;

            }

              .add-btn {
                    font-size: 0.95rem;
                    padding: 0.4rem 0.8rem;

            }
        }



          .delete-btn {
                position: absolute;
                top: 6px;
                right: 6px;
                background: #ff4d4d;
                color: white;
                border: none;
                font-size: 0.8rem;
                padding: 4px 8px;
                cursor: pointer;
                border-radius: 4px;

        }

          .text-content {
                text-align: center;
                line-height: 2 !important;
                word-break: break-word;
                min-height: 80px;
                padding: 0.8rem;
                border: 1px solid #ccc;
                border-radius: 6px;
                background: #fafafa;

        }

          .layout-block {
                display: flex;
                gap: 1rem;
                margin: 1rem 0;
                border: 2px dashed #999;
                padding: 1rem;
                position: relative;

        }

              .layout-block::before {
                    content: "레이아웃: 드래그로 위치 변경 가능";
                    position: absolute;
                    top: -1.2rem;
                    left: 0;
                    font-size: 0.9rem;
                    color: #666;

            }

          .layout-column {
                flex: 1;
                min-height: 100px;
                background: #f0f0f0;
                padding: 0.5rem;
                border-radius: 6px;

        }

        .layout-block input[type="color"],
        .layout-block input[type="file"] {
              width: 90px;
                        /* 너비 확 줄이기 */
              display: block;
                      /* 줄바꿈 */
              margin-bottom: 6px;
                  /* 아래 여백 */
              font-size: 0.9rem;
              padding: 3px;
        }


          .preview .layout-block,
          .preview .layout-block::before {
                border: none !important;
                content: "" !important;

        }

          .preview .layout-column {
                background: none !important;
                padding: 0 !important;

        }
    </style>
</head>
<body>
    <h1>웹사이트 페이지 만들기</h1>
    <form id="page-form">
        <div style="background:#f0f4f8; padding:0.75rem 1rem; border-left:4px solid #bcdcff; margin-bottom:1rem; font-size:0.95rem; border-radius:6px;">
            ✨ <strong>단축키 안내</strong><br />
            <ul style="margin: 0.5rem 0 0 1rem; padding-left: 1rem; list-style: disc;">
                <li><kbd>Ctrl</kbd> + <kbd>B</kbd>: <strong>굵게</strong></li>
                <li><kbd>Ctrl</kbd> + <kbd>I</kbd>: <em>기울임</em></li>
                <li><kbd>Ctrl</kbd> + <kbd>U</kbd>: <u>밑줄</u></li>
                <li><kbd>Ctrl</kbd> + <kbd>1</kbd>: <code>&lt;h1&gt;</code> (큰 제목)</li>
                <li><kbd>Ctrl</kbd> + <kbd>2</kbd>: <code>&lt;h2&gt;</code> (중간 제목)</li>
                <li><kbd>Ctrl</kbd> + <kbd>3</kbd>: <code>&lt;p&gt;</code> (본문)</li>
            </ul>
        </div>
        <label>제목</label>
        <input id="title" required type="text" />
        <label>슬러그 (URL 주소: 영문, 예: game-study)</label>
        <input id="slug" required type="text" />
        <label>설명</label>
        <textarea id="description" required rows="4"></textarea>
        <label>본문 콘텐츠</label>
        <div class="button-group">
            <button type="button" class="add-btn" onclick="addTextBlock()">+ 텍스트</button>
            <button type="button" class="add-btn" onclick="addLinkButtonBlock()">+ 버튼</button>
            <button type="button" class="add-btn" onclick="addPdfBlock()">+ PDF</button>
            <button type="button" class="add-btn" onclick="addImageBlock()">+ 이미지</button>
            <button type="button" class="add-btn" onclick="addDivider()">+ 구분선</button>
            <button type="button" class="add-btn" onclick="addYoutubeBlock()">+ 유튜브</button>
            <button type="button" class="add-btn" onclick="addLayoutBlock(1)">+ 1단 레이아웃</button>
            <button type="button" class="add-btn" onclick="addLayoutBlock(2)">+ 2단 레이아웃</button>
            <button type="button" class="add-btn" onclick="addLayoutBlock(3)">+ 3단 레이아웃</button>
        </div>

        <div id="editor-area"></div>
        <button type="button" onclick="saveAsJSON()">JSON으로 임시저장</button>
        <button type="button" onclick="savePage()">HTML로 저장</button>

        <label style="display: inline-block; margin: 1rem 0;">
            임시저장된 JSON 불러오기
            <input type="file" accept=".json" onchange="loadFromJSON(event)" style="margin-top: 0.5rem;">
        </label>



    </form>
    <div class="preview" id="pagePreview"></div>
    <script>
        const editorArea = document.getElementById('editor-area');

        function addDeleteButton(div) {
            const del = document.createElement('button');
            del.className = 'delete-btn';
            del.innerText = '삭제';
            del.onclick = () => div.remove();
            div.appendChild(del);
        }


        function saveAsJSON() {
            const data = {
                title: document.getElementById('title').value,
                slug: document.getElementById('slug').value,
                description: document.getElementById('description').value,
                content: editorArea.innerHTML
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = (data.slug || 'draft') + '.json';
            a.click();
        }

        function loadFromJSON(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = e => {
                const data = JSON.parse(e.target.result);
                document.getElementById('title').value = data.title || '';
                document.getElementById('slug').value = data.slug || '';
                document.getElementById('description').value = data.description || '';

                editorArea.innerHTML = ''; // 기존 콘텐츠 제거

                const temp = document.createElement('div');
                temp.innerHTML = data.content || '';

                Array.from(temp.children).forEach(block => {
                    // 삭제 버튼 추가
                    addDeleteButton(block);
                    // 불러온 블록 안의 색상 선택기 기능 다시 연결
                    block.querySelectorAll('.editor-block').forEach(editor => {
                        const colorInput = editor.querySelector('input[type="color"]');
                        const textDiv = editor.querySelector('.text-content');

                        if (colorInput && textDiv) {
                            colorInput.addEventListener('input', () => {
                                const color = colorInput.value;
                                textDiv.style.color = color;

                                // 내부 모든 요소(span, p, br 등)에 강제로 색 적용
                                textDiv.querySelectorAll('*').forEach(child => {
                                    child.style.color = color;
                                });
                            });

                        }
                    });

                    // 텍스트 블록 <p>를 <div contenteditable>로 복구
                    block.querySelectorAll('p').forEach(p => {
                        const editable = document.createElement('div');
                        editable.className = 'text-content';
                        editable.contentEditable = true;
                        editable.innerHTML = p.innerHTML;

                        // 스타일 복사 (색상, 정렬, 줄간격)
                        editable.style.color = p.style.color || '';
                        editable.style.textAlign = p.style.textAlign || '';
                        editable.style.lineHeight = p.style.lineHeight || '';

                        p.replaceWith(editable);
                    });

                    // 레이아웃 내부 블록에도 삭제 버튼 다시 붙이기
                    block.querySelectorAll('.editor-block').forEach(inner => {
                        addDeleteButton(inner);
                    });

                    editorArea.appendChild(block);
                });
            };

            reader.readAsText(file);
        }




        function addTextBlock() {
            const div = document.createElement('div');
            div.className = 'editor-block';

            div.innerHTML = `
        <input type="color" value="#000000" style="width: 90px; margin-bottom: 6px;" />
        <div class="text-content" contenteditable="true">텍스트 입력</div>
      `;

            const colorInput = div.querySelector('input[type="color"]');
            const textDiv = div.querySelector('.text-content');

            colorInput.addEventListener('input', () => {
                textDiv.style.color = colorInput.value;
            });

            addDeleteButton(div);
            editorArea.appendChild(div);
        }


        function addImageBlock() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.style.display = 'none';
            input.onchange = () => {
                const file = input.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = () => {
                    const div = document.createElement('div');
                    div.className = 'editor-block';
                    div.innerHTML = `
            <img src="${reader.result}" style="width: 50%; max-width: 100%; border-radius: 4px;" />
            <input type="range" min="10" max="100" value="50"
                   style="width: 100%; margin-top: 8px;"
                   oninput="this.previousElementSibling.style.width = this.value + '%'">
          `;
                    addDeleteButton(div);
                    editorArea.appendChild(div);
                };
                reader.readAsDataURL(file);
            };
            document.body.appendChild(input);
            input.click();
            document.body.removeChild(input);
        }

        function addDivider() {
            const div = document.createElement('div');
            div.className = 'editor-block';
            div.innerHTML = `
        <hr style="
          border: none;
          border-top: 2px solid #ccc;
          width: 70%;
          max-width: 1500px;
          margin: 2rem auto;
        " />
      `;
            addDeleteButton(div);
            editorArea.appendChild(div);
        }



        function addYoutubeBlock() {
            const div = document.createElement('div');
            div.className = 'editor-block';
            div.innerHTML = `
        <input type="url" placeholder="유튜브 링크 (예: https://www.youtube.com/watch?v=영상ID)" style="width: 100%; margin-bottom: 8px;" />
        <iframe
          style="aspect-ratio: 16 / 9; width: 50%; max-width: 1000px; border-radius: 8px; display: none; display: block; margin: 0 auto;"
          frameborder="0"
          allowfullscreen
        ></iframe>
      `;

            const input = div.querySelector('input');
            const iframe = div.querySelector('iframe');

            input.addEventListener('input', () => {
                const url = input.value;
                const match = url.match(/(?:youtube\.com\/watch\\?v=|youtu\.be\/)([a-zA-Z0-9_-]+)/);
                if (match && match[1]) {
                    iframe.src = `https://www.youtube.com/embed/${match[1]}`;
                    iframe.style.display = 'block';
                } else {
                    iframe.src = '';
                    iframe.style.display = 'none';
                }
            });

            addDeleteButton(div);
            editorArea.appendChild(div);
        }



        function addLinkButtonBlock() {
            const div = document.createElement('div');
            div.className = 'editor-block';
            div.innerHTML = `
        <input type="text" placeholder="버튼 텍스트" style="margin-bottom: 6px; width: 100%;" />
        <input type="url" placeholder="링크 URL (예: https://example.com)" style="margin-bottom: 6px; width: 100%;" />
        <a href="#" class="button" target="_blank">버튼 텍스트</a>
      `;

            const [textInput, urlInput] = div.querySelectorAll('input');
            const buttonLink = div.querySelector('a');

            function updateButton() {
                buttonLink.textContent = textInput.value || '버튼 텍스트';
                buttonLink.href = urlInput.value || '#';
            }

            textInput.addEventListener('input', updateButton);
            urlInput.addEventListener('input', updateButton);

            addDeleteButton(div);
            editorArea.appendChild(div);
        }


        function updateLink(input) {
            const block = input.closest('.editor-block');
            const [textInput, urlInput] = block.querySelectorAll('input');
            const link = block.querySelector('a');
            link.textContent = textInput.value || '링크 텍스트';
            link.href = urlInput.value || '#';
        }

        function addPdfBlock() {
            const div = document.createElement('div');
            div.className = 'editor-block';
            div.innerHTML = `
        <input type="url" placeholder="PDF 링크 (https://...)" />
        <iframe src="" style="display:none;"></iframe>
      `;
            const input = div.querySelector('input');
            const iframe = div.querySelector('iframe');
            input.addEventListener('input', () => {
                if (input.value.startsWith('http')) {
                    iframe.src = input.value;
                    iframe.style.display = 'block';
                } else {
                    iframe.src = '';
                    iframe.style.display = 'none';
                }
            });
            addDeleteButton(div);
            editorArea.appendChild(div);
        }

        function addLayoutBlock(columns) {
            const layout = document.createElement('div');
            layout.className = 'layout-block';

            // 배경색 + 이미지 업로드 UI
            const controls = document.createElement('div');
            controls.style.marginBottom = '0.5rem';
            controls.innerHTML = `
        <input type="color" title="배경색 선택" />
        <input type="file" accept="image/*" title="배경 이미지 업로드" />
      `;

            const colorInput = controls.querySelector('input[type="color"]');
            const fileInput = controls.querySelector('input[type="file"]');

            colorInput.addEventListener('input', () => {
                layout.style.backgroundColor = colorInput.value;
            });

            fileInput.addEventListener('change', () => {
                const file = fileInput.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = () => {
                    layout.style.backgroundImage = `url(${reader.result})`;
                    layout.style.backgroundSize = 'cover';
                    layout.style.backgroundPosition = 'center';
                };
                reader.readAsDataURL(file);
            });

            layout.appendChild(controls);

            for (let i = 0; i < columns; i++) {
                const col = document.createElement('div');
                col.className = 'layout-column';
                col.innerHTML = '<p style="text-align:center; color:#888;">여기에 콘텐츠를 드래그하세요</p>';
                layout.appendChild(col);
            }

            addDeleteButton(layout);
            editorArea.appendChild(layout);
        }


        function previewPage() {
            const title = document.getElementById('title').value;
            const description = document.getElementById('description').value;
            const content = Array.from(editorArea.children).map(el => {
                const clone = el.cloneNode(true);
                clone.querySelectorAll('.delete-btn, input, select').forEach(e => e.remove());
                clone.querySelectorAll('[contenteditable]').forEach(e => {
                    const p = document.createElement('p');
                    p.innerHTML = e.innerHTML;
                    e.replaceWith(p);
                });
                return clone.outerHTML;
            }).join('\n');

            document.getElementById('pagePreview').innerHTML = `
        <style>
          h1 { text-align: center; }
          body { font-family: sans-serif; text-align: center; }
          img { max-width: 100%; }
          .button {
            display: inline-block;
            padding: 8px 16px;
            background-color: #000;
            color: #fff;
            text-decoration: none;
            margin-top: 6px;
            border-radius: 6px;
          }
        </style>
        <h1>${title}</h1>
        <p>${description}</p>
        ${content}`;
        }

        function savePage() {
            const title = document.getElementById('title').value;
            const slug = document.getElementById('slug').value.trim() || 'untitled';
            const description = document.getElementById('description').value;

            // 이 함수 전체를 복사해서 기존 cleanElement 함수 자리에 덮어쓰기
            function cleanElement(el) {
                const clone = el.cloneNode(true);

                // ▼▼▼ [추가된 부분] 입력창 지우기 전에 주소 옮기기 ▼▼▼
                const iframe = clone.querySelector('iframe');
                // clone이 아니라 원본(el)에서 값을 가져와야 정확함
                const input = el.querySelector('input[type="url"]');

                if (iframe && input && input.value) {
                    iframe.src = input.value;       // 주소 복사
                    iframe.style.display = 'block'; // 보이게 설정
                    iframe.style.height = '800px';  // 저장된 파일에서 높이 고정
                    iframe.style.border = 'none';   // 테두리 제거
                }
                // ▲▲▲ [여기까지 추가됨] ▲▲▲

                // 이제 불필요한 입력창과 버튼 삭제
                clone.querySelectorAll('.delete-btn, input, select').forEach(e => e.remove());

                // 텍스트 에디터 변환 (기존 코드 유지)
                clone.querySelectorAll('[contenteditable]').forEach(e => {
                    const wrapper = document.createElement('div');
                    wrapper.innerHTML = e.innerHTML;
                    if (e.style.color) wrapper.style.color = e.style.color;
                    if (e.style.textAlign) wrapper.style.textAlign = e.style.textAlign;
                    wrapper.style.lineHeight = '2';
                    e.replaceWith(wrapper);
                });

                return clone;
            }




            const content = Array.from(editorArea.children).map(el => {
                const clone = cleanElement(el);

                if (el.classList.contains('layout-block')) {
                    const originalCols = el.querySelectorAll('.layout-column');
                    const clonedCols = clone.querySelectorAll('.layout-column');

                    clonedCols.forEach((col, i) => {
                        col.innerHTML = '';
                        const originalCol = originalCols[i];
                        if (originalCol) {
                            const blocks = originalCol.querySelectorAll('.editor-block');
                            blocks.forEach(block => {
                                col.appendChild(cleanElement(block)); // 이 부분에서 정확히 i번째 col을 사용해야 함
                            });
                        }
                    });
                }

                return clone.outerHTML;
            }).join('\n');


            const finalHTML = `<!DOCTYPE html>
<html lang="ko">
<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>${title}</title>
      <style>

        @font-face {
font-family: 'Pretendard';
src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Thin.woff') format('woff');
font-weight: 100;
font-style: normal;
}

@font-face {
font-family: 'Pretendard';
src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-ExtraLight.woff') format('woff');
font-weight: 200;
font-style: normal;
}

@font-face {
font-family: 'Pretendard';
src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Light.woff') format('woff');
font-weight: 300;
font-style: normal;
}

@font-face {
font-family: 'Pretendard';
src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Regular.woff') format('woff');
font-weight: 400;
font-style: normal;
}

@font-face {
font-family: 'Pretendard';
src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Medium.woff') format('woff');
font-weight: 500;
font-style: normal;
}

@font-face {
font-family: 'Pretendard';
src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-SemiBold.woff') format('woff');
font-weight: 600;
font-style: normal;
}

@font-face {
font-family: 'Pretendard';
src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Bold.woff') format('woff');
font-weight: 700;
font-style: normal;
}

@font-face {
font-family: 'Pretendard';
src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-ExtraBold.woff') format('woff');
font-weight: 800;
font-style: normal;
}

@font-face {
font-family: 'Pretendard';
src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Black.woff') format('woff');
font-weight: 900;
font-style: normal;
}

/* 사이트_전체에_적용 */
body, p, span, h1, h2, h3, h4, h5, h6, div, a {
      line-height: 2; /* 줄간격 2배 */
font-family: 'Pretendard', sans-serif !important;
}

html, body {
      margin: 0;
      padding: 0;
}

        h1 { text-align: center; }
        body {
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      text-align: center; }
        img { max-width: 100%; }
        .layout-block { display: flex; gap: 1rem; margin: 1rem 0; }
        .layout-column { flex: 1; }
        .button {
          display: inline-block;
          padding: 8px 16px;
          background-color: #000;
          color: #fff;
          text-decoration: none;
          margin-top: 6px;
          border-radius: 6px;
        }

        body {
          padding-top: 30px; /* 네비바_높이에_맞게_조정 */
        }

        section:first-of-type {
          scroll-margin-top: 80px; /* 앵커_이동 시_겹치지_않게 */
        }

@media (max-width: 768px) {
      body {
        padding: 2rem 1rem;
        font-size: 16px;
        line-height: 1.8;
      }

      h1, h2, h3 {
        font-size: 1.3rem;
        margin-bottom: 1rem;
      }

      p {
        font-size: 1rem;
        margin: rem auto;
        padding: 0 1rem;
        max-width: 80%;
      }

      iframe {
        width: 80% !important;
        max-width: 80% !important;
        margin: 1.5rem auto;
        display: block;
        border-radius: 8px;
      }

      .layout-block {
      width: 100vw;                /* 뷰포트 전체 너비 차지 */
      margin-left: calc(-50vw + 50%);  /* 부모 max-width 무효화 */
      padding: 0;                  /* 바깥 여백 제거 */
      border: none;                /* 개발용 테두리 제거 가능 */
      }

      }

      iframe {
                width: 100%;
                max-width: 1200px;
                height: 800px; /* PC 높이 */
                display: block;
                margin: 20px auto;
                border: none;
            }

            @media (max-width: 768px) {
                iframe { height: 500px !important; } /* 모바일 높이 */
            }


</style>

</head>
<body>
      <script src="/navbar.js"><\/script>
      <h1>${title}</h1>
      <p>${description}</p>
      ${content}
      <script>
document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll('a').forEach(function(link) {
        if (link.hostname !== window.location.hostname) {
          link.setAttribute('target', '_blank');
        } else {
          link.removeAttribute('target');
        }
      });
});

document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
});
<\/script>
</body>
</html>`;

            const blob = new Blob([finalHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = slug.endsWith('.html') ? slug : slug + '.html';
            a.click();
        }


        window.addEventListener('load', () => {
            new Sortable(editorArea, {
                group: 'shared',
                animation: 150,
                draggable: '.editor-block, .layout-block',  // ✅ layout-block도 포함
                fallbackOnBody: true,
                swapThreshold: 0.65
            });

            const observer = new MutationObserver(() => {
                document.querySelectorAll('.layout-column').forEach(col => {
                    if (!col.classList.contains('sortable-ready')) {
                        new Sortable(col, {
                            group: 'shared',
                            animation: 150,
                            handle: '.editor-block',
                            draggable: '.editor-block'
                        });
                        col.classList.add('sortable-ready');
                    }
                });
            });

            observer.observe(editorArea, { childList: true, subtree: true });
        });

        document.addEventListener('keydown', function (e) {
            const active = document.activeElement;
            if (!active || !active.isContentEditable) return;

            // Ctrl+B → bold
            if (e.ctrlKey && e.key === 'b') {
                e.preventDefault();
                document.execCommand('bold');
            }

            // Ctrl+1/2/3 → font size (simulate by headings)
            if (e.ctrlKey && ['1', '2', '3'].includes(e.key)) {
                e.preventDefault();
                const tag = e.key === '1' ? 'h1' : e.key === '2' ? 'h2' : 'p';
                document.execCommand('formatBlock', false, tag);
            }

            // Ctrl+Shift+L/C/R → text-align
            if (e.ctrlKey && e.shiftKey) {
                if (e.key === 'l') {
                    e.preventDefault();
                    document.execCommand('justifyLeft');
                } else if (e.key === 'c') {
                    e.preventDefault();
                    document.execCommand('justifyCenter');
                } else if (e.key === 'r') {
                    e.preventDefault();
                    document.execCommand('justifyRight');
                }
            }
        });


    </script>

</body>
</html>

